Improve safety in range checks